{
  "AWSTemplateFormatVersion": "2010-09-09",
  "Parameters": {
    "TablePrefix": {
      "Default": "console-private",
      "Description": "",
      "Type": "String"
    },
    "AuditLogsReadCapacity": {
      "Default": 50,
      "Description": "",
      "Type": "Number"
    },
    "AuditLogsWriteCapacity": {
      "Default": 20,
      "Description": "",
      "Type": "Number"
    },
    "AuditLogsRackIndexReadCapacity": {
      "Default": 50,
      "Description": "",
      "Type": "Number"
    },
    "AuditLogsRackIndexWriteCapacity": {
      "Default": 20,
      "Description": "",
      "Type": "Number"
    },
    "DeployKeysReadCapacity": {
      "Default": 10,
      "Description": "",
      "Type": "Number"
    },
    "DeployKeysWriteCapacity": {
      "Default": 5,
      "Description": "",
      "Type": "Number"
    },
    "DeployKeysKeyHashIndexReadCapacity": {
      "Default": 10,
      "Description": "",
      "Type": "Number"
    },
    "DeployKeysKeyHashIndexWriteCapacity": {
      "Default": 5,
      "Description": "",
      "Type": "Number"
    },
    "DeployKeysOrganizationIdIndexReadCapacity" :{
      "Default": 10,
      "Description": "",
      "Type": "Number"
    },
    "DeployKeysOrganizationIdIndexWriteCapacity":{
      "Default": 5,
      "Description": "",
      "Type": "Number"
    },
    "IntegrationsReadCapacity": {
      "Default": 10,
      "Description": "",
      "Type": "Number"
    },
    "IntegrationsWriteCapacity": {
      "Default": 1,
      "Description": "",
      "Type": "Number"
    },
    "IntegrationsProviderIndexReadCapacity": {
      "Default": 10,
      "Description": "",
      "Type": "Number"
    },
    "IntegrationsProviderIndexWriteCapacity": {
      "Default": 1,
      "Description": "",
      "Type": "Number"
    }, 
    "IntegrationsOrganizationIdIndexReadCapacity": {
      "Default": 10,
      "Description": "",
      "Type": "Number"
    }, 
    "IntegrationsOrganizationIdIndexWriteCapacity": {
      "Default": 1,
      "Description": "",
      "Type": "Number"
    }, 
    "InstallsReadCapacity": {
      "Default": 20,
      "Description": "",
      "Type": "Number"
    },
    "InstallsWriteCapacity": {
      "Default": 1,
      "Description": "",
      "Type": "Number"
    },
    "InstallsUserIdIndexWriteCapacity": {
      "Default": 20,
      "Description": "",
      "Type": "Number"
    }, 
    "InstallsUserIdIndexReadCapacity": {
      "Default": 1,
      "Description": "",
      "Type": "Number"
    },
    "OrganizationsReadCapacity": {
      "Default": 50,
      "Description": "",
      "Type": "Number"
    },
    "OrganizationsWriteCapacity": {
      "Default": 5,
      "Description": "",
      "Type": "Number"
    },
    "OrganizationsNameIndexReadCapacity": {
      "Default": 50,
      "Description": "",
      "Type": "Number"
    }, 
    "OrganizationsNameIndexWriteCapacity": {
      "Default": 5,
      "Description": "",
      "Type": "Number"
    },
    "OrganizationInvitesReadCapacity": {
      "Default": 50,
      "Description": "",
      "Type": "Number"
    },
    "OrganizationInvitesWriteCapacity": {
      "Default": 5,
      "Description": "",
      "Type": "Number"
    },
    "OrganizationInvitesEmailIndexReadCapacity": {
      "Default": 50,
      "Description": "",
      "Type": "Number"
    }, 
    "OrganizationInvitesEmailIndexWriteCapacity": {
      "Default": 5,
      "Description": "",
      "Type": "Number"
    }, 
    "OrganizationInvitesTokenIndexReadCapacity": {
      "Default": 50,
      "Description": "",
      "Type": "Number"
    }, 
    "OrganizationInvitesTokenIndexWriteCapacity": {
      "Default": 5,
      "Description": "",
      "Type": "Number"
    }, 
    "OrganizationInvitesInviterIdIndexReadCapacity": {
      "Default": 50,
      "Description": "",
      "Type": "Number"
    },
    "OrganizationInvitesInviterIdIndexWriteCapacity": {
      "Default": 5,
      "Description": "",
      "Type": "Number"
    }, 
    "OrganizationInvitesOrganizationIdIndexReadCapacity": {
      "Default": 50,
      "Description": "",
      "Type": "Number"
    }, 
    "OrganizationInvitesOrganizationIdIndexWriteCapacity": {
      "Default": 5,
      "Description": "",
      "Type": "Number"
    }, 
    "RacksReadCapacity": {
      "Default": 50,
      "Description": "",
      "Type": "Number"
    },
    "RacksWriteCapacity": {
      "Default": 5,
      "Description": "",
      "Type": "Number"
    },
    "RacksOrganizationIdIndexReadCapacity": {
      "Default": 50,
      "Description": "",
      "Type": "Number"
    }, 
    "RacksOrganizationIdIndexWriteCapacity": {
      "Default": 5,
      "Description": "",
      "Type": "Number"
    }, 
    "RacksCreatorIndexReadCapacity": {
      "Default": 50,
      "Description": "",
      "Type": "Number"
    }, 
    "RacksCreatorIndexWriteCapacity": {
      "Default": 5,
      "Description": "",
      "Type": "Number"
    },
    "UsersReadCapacity": {
      "Default": 100,
      "Description": "",
      "Type": "Number"
    },
    "UsersWriteCapacity": {
      "Default": 5,
      "Description": "",
      "Type": "Number"
    },
    "UsersApiKeyHashIndexReadCapacity": {
      "Default": 100,
      "Description": "",
      "Type": "Number"
    }, 
    "UsersApiKeyHashIndexWriteCapacity": {
      "Default": 5,
      "Description": "",
      "Type": "Number"
    },
    "UsersEmailIndexReadCapacity": {
      "Default": 100,
      "Description": "",
      "Type": "Number"
    }, 
    "UsersEmailIndexWriteCapacity": {
      "Default": 5,
      "Description": "",
      "Type": "Number"
    }, 
    "WebhooksReadCapacity": {
      "Default": 50,
      "Description": "",
      "Type": "Number"
    },
    "WebhooksWriteCapacity": {
      "Default": 1,
      "Description": "",
      "Type": "Number"
    },
    "WebhooksAppIdIndexReadCapacity": {
      "Default": 50,
      "Description": "",
      "Type": "Number"
    }, 
    "WebhooksAppIdIndexWriteCapacity": {
      "Default": 1,
      "Description": "",
      "Type": "Number"
    },
    "WebhooksIntegrationIdIndexReadCapacity": {
      "Default": 50,
      "Description": "",
      "Type": "Number"
    }, 
    "WebhooksIntegrationIdIndexWriteCapacity": {
      "Default": 1,
      "Description": "",
      "Type": "Number"
    }, 
    "WebhooksRackIdIndexReadCapacity": {
      "Default": 50,
      "Description": "",
      "Type": "Number"
    }, 
    "WebhooksRackIdIndexWriteCapacity": {
      "Default": 1,
      "Description": "",
      "Type": "Number"
    }, 
    "WebhooksRemoteIdIndexReadCapacity": {
      "Default": 50,
      "Description": "",
      "Type": "Number"
    }, 
    "WebhooksRemoteIdIndexWriteCapacity": {
      "Default": 1,
      "Description": "",
      "Type": "Number"
    }
  },
  "Outputs": {
    "DynamoDBAccessKeyId": {
      "Value": {
        "Ref": "ConsolePrivateDynamoDBAccess"
      }
    },
    "DynamoDBSecretAccessKey": {
      "Value": { "Fn::GetAtt": [ "ConsolePrivateDynamoDBAccess", "SecretAccessKey" ] }
    }
  },
  "Resources": {
    "ConsolePrivateDynamoDBUser": {
      "Type": "AWS::IAM::User",
      "Properties": {
        "Policies": [
          {
            "PolicyName": "ConsolePrivateDynamoDBFullAccess",
            "PolicyDocument": {
              "Version": "2012-10-17",
              "Statement": [{ 
                "Effect": "Allow", 
                "Action": [
                  "dynamodb:BatchGetItem",
                  "dynamodb:BatchWriteItem",
                  "dynamodb:DeleteItem",
                  "dynamodb:DescribeStream",
                  "dynamodb:DescribeTable",
                  "dynamodb:GetItem",
                  "dynamodb:GetRecords",
                  "dynamodb:ListStreams",
                  "dynamodb:ListTables",
                  "dynamodb:PutItem",
                  "dynamodb:Query",
                  "dynamodb:UpdateItem"
                ],
                "Resource": {
                  "Fn::Join": [
                    "", 
                    [
                      "arn:aws:dynamodb:*:*:table/",
                      {"Ref": "TablePrefix"},
                      "-*"
                    ]
                  ]
                }
              }]
            }
          }
        ]
      }
    },
    "ConsolePrivateDynamoDBAccess": {
      "Type": "AWS::IAM::AccessKey",
      "Properties": {
        "Serial": "1",
        "Status": "Active",
        "UserName": { "Ref": "ConsolePrivateDynamoDBUser" }
      }
    },
    "ConsolePrivateUsersDynamoDBTable" : {
      "Type" : "AWS::DynamoDB::Table",
      "Properties" : {
        "TableName" : {"Fn::Join" : ["", [{"Ref": "TablePrefix"}, "-users" ]]},
        "AttributeDefinitions" : [
          { "AttributeName" : "id", "AttributeType" : "S" },
          { "AttributeName" : "email", "AttributeType" : "S" },
          { "AttributeName" : "api-key-hash", "AttributeType" : "S" },
        ],
        "KeySchema" : [{ "AttributeName" : "id", "KeyType" : "HASH" }],
        "ProvisionedThroughput" : { "ReadCapacityUnits" : { "Ref": "UsersReadCapacity" }, "WriteCapacityUnits" : { "Ref": "UsersWriteCapacity" } },
        "GlobalSecondaryIndexes" : [{
          "IndexName" : "email-index",
          "Projection": { "ProjectionType": "ALL" },
          "KeySchema" : [{ "AttributeName" : "email", "KeyType" : "HASH"}],                         
          "ProvisionedThroughput" : { "ReadCapacityUnits" : { "Ref": "UsersEmailIndexReadCapacity" }, "WriteCapacityUnits" : { "Ref": "UsersEmailIndexWriteCapacity" } }
        },
        {
          "IndexName" : "api-key-hash-index",
          "Projection": { "ProjectionType": "ALL" },
          "KeySchema" : [{ "AttributeName" : "api-key-hash", "KeyType" : "HASH" }],                         
          "ProvisionedThroughput" : { "ReadCapacityUnits" : { "Ref": "UsersApiKeyHashIndexReadCapacity" }, "WriteCapacityUnits" : { "Ref": "UsersApiKeyHashIndexWriteCapacity" } }
        }]
      }
    },
    "ConsolePrivateOrganizationsDynamoDBTable" : {
      "Type" : "AWS::DynamoDB::Table",
      "Properties" : {
        "TableName" : {"Fn::Join" : ["", [{"Ref": "TablePrefix"}, "-organizations" ]]},
        "AttributeDefinitions" : [
          { "AttributeName" : "id", "AttributeType" : "S" },
          { "AttributeName" : "name", "AttributeType" : "S" }
        ],
        "KeySchema" : [{ "AttributeName" : "id", "KeyType" : "HASH" }],
        "ProvisionedThroughput" : { "ReadCapacityUnits" : "1", "WriteCapacityUnits" : "1" },
        "ProvisionedThroughput" : { "ReadCapacityUnits" : { "Ref": "OrganizationsReadCapacity" }, "WriteCapacityUnits" : { "Ref": "OrganizationsWriteCapacity" } },
        "GlobalSecondaryIndexes" : [{
          "IndexName" : "name-index",
          "Projection": { "ProjectionType": "ALL" },
          "KeySchema" : [{ "AttributeName" : "name", "KeyType" : "HASH"}],                         
          "ProvisionedThroughput" : { "ReadCapacityUnits" : { "Ref": "OrganizationsNameIndexReadCapacity" }, "WriteCapacityUnits" : { "Ref": "OrganizationsNameIndexWriteCapacity" } }
        }]
      }
    },
    "ConsolePrivateOrganizationInvitesDynamoDBTable" : {
      "Type" : "AWS::DynamoDB::Table",
      "DependsOn" : "ConsolePrivateOrganizationsDynamoDBTable" ,
      "Properties" : {
        "TableName" : {"Fn::Join" : ["", [{"Ref": "TablePrefix"}, "-organization-invites" ]]},
        "AttributeDefinitions" : [
          { "AttributeName" : "id", "AttributeType" : "S" },
          { "AttributeName" : "email", "AttributeType" : "S" },
          { "AttributeName" : "organization-id", "AttributeType" : "S" },
          { "AttributeName" : "inviter-id", "AttributeType" : "S" },
          { "AttributeName" : "token", "AttributeType" : "S" }
        ],
        "KeySchema" : [{ "AttributeName" : "id", "KeyType" : "HASH" }],
        "ProvisionedThroughput" : { "ReadCapacityUnits" : { "Ref": "OrganizationInvitesReadCapacity" }, "WriteCapacityUnits" : { "Ref": "OrganizationInvitesWriteCapacity" } },
        "GlobalSecondaryIndexes" : [{
          "IndexName" : "email-index",
          "Projection": { "ProjectionType": "ALL" },
          "KeySchema" : [{ "AttributeName" : "email", "KeyType" : "HASH"}],                         
          "ProvisionedThroughput" : { "ReadCapacityUnits" : { "Ref": "OrganizationInvitesEmailIndexReadCapacity" }, "WriteCapacityUnits" : { "Ref": "OrganizationInvitesEmailIndexWriteCapacity" } }
        }, {
        "IndexName" : "organization-id-index",
        "Projection": { "ProjectionType": "ALL" },
        "KeySchema" : [{ "AttributeName" : "organization-id", "KeyType" : "HASH"}],                         
        "ProvisionedThroughput" : { "ReadCapacityUnits" : { "Ref": "OrganizationInvitesOrganizationIdIndexReadCapacity" }, "WriteCapacityUnits" : { "Ref": "OrganizationInvitesOrganizationIdIndexWriteCapacity" } }
        }, {
        "IndexName" : "inviter-id-index",
        "Projection": { "ProjectionType": "ALL" },
        "KeySchema" : [{ "AttributeName" : "inviter-id", "KeyType" : "HASH"}],                         
        "ProvisionedThroughput" : { "ReadCapacityUnits" : { "Ref": "OrganizationInvitesInviterIdIndexReadCapacity" }, "WriteCapacityUnits" : { "Ref": "OrganizationInvitesInviterIdIndexWriteCapacity" } }
        }, {
        "IndexName" : "token-index",
        "Projection": { "ProjectionType": "ALL" },
        "KeySchema" : [{ "AttributeName" : "token", "KeyType" : "HASH"}],                         
        "ProvisionedThroughput" : { "ReadCapacityUnits" : { "Ref": "OrganizationInvitesTokenIndexReadCapacity" }, "WriteCapacityUnits" : { "Ref": "OrganizationInvitesTokenIndexWriteCapacity" } }
        }]
      }
    },
    "ConsolePrivateRacksDynamoDBTable" : {
      "Type" : "AWS::DynamoDB::Table",
      "DependsOn" : "ConsolePrivateOrganizationInvitesDynamoDBTable" ,
      "Properties" : {
        "TableName" : {"Fn::Join" : ["", [{"Ref": "TablePrefix"}, "-racks" ]]},
        "AttributeDefinitions" : [
          { "AttributeName" : "id", "AttributeType" : "S" },
          { "AttributeName" : "organization-id", "AttributeType" : "S" },
          { "AttributeName" : "creator", "AttributeType" : "S" }
        ],
        "KeySchema" : [{ "AttributeName" : "id", "KeyType" : "HASH" }],
        "ProvisionedThroughput" : { "ReadCapacityUnits" : { "Ref": "RacksReadCapacity" }, "WriteCapacityUnits" : { "Ref": "RacksWriteCapacity" } },
        "GlobalSecondaryIndexes" : [{
          "IndexName" : "creator-index",
          "Projection": { "ProjectionType": "ALL" },
          "KeySchema" : [{ "AttributeName" : "creator", "KeyType" : "HASH"}],                         
        "ProvisionedThroughput" : { "ReadCapacityUnits" : { "Ref": "RacksCreatorIndexReadCapacity" }, "WriteCapacityUnits" : { "Ref": "RacksCreatorIndexWriteCapacity" } },
        }, {
        "IndexName" : "organization-id-index",
        "Projection": { "ProjectionType": "ALL" },
        "KeySchema" : [{ "AttributeName" : "organization-id", "KeyType" : "HASH"}],                         
        "ProvisionedThroughput" : { "ReadCapacityUnits" : { "Ref": "RacksOrganizationIdIndexReadCapacity" }, "WriteCapacityUnits" : { "Ref": "RacksOrganizationIdIndexWriteCapacity" } }
        }]
      }
    },
    "ConsolePrivateInstallsDynamoDBTable" : {
      "Type" : "AWS::DynamoDB::Table",
      "DependsOn" : "ConsolePrivateRacksDynamoDBTable" ,
      "Properties" : {
        "TableName" : {"Fn::Join" : ["", [{"Ref": "TablePrefix"}, "-installs" ]]},
        "AttributeDefinitions" : [
          { "AttributeName" : "id", "AttributeType" : "S" },
          { "AttributeName" : "user-id", "AttributeType" : "S" }
        ],
        "KeySchema" : [{ "AttributeName" : "id", "KeyType" : "HASH" }],
        "ProvisionedThroughput" : { "ReadCapacityUnits" : { "Ref": "InstallsReadCapacity" }, "WriteCapacityUnits" : { "Ref": "InstallsWriteCapacity" } },
        "GlobalSecondaryIndexes" : [{
          "IndexName" : "user-id-index",
          "Projection": { "ProjectionType": "ALL" },
          "KeySchema" : [{ "AttributeName" : "user-id", "KeyType" : "HASH"}],                         
          "ProvisionedThroughput" : { "ReadCapacityUnits" : { "Ref": "InstallsUserIdIndexReadCapacity" }, "WriteCapacityUnits" : { "Ref": "InstallsUserIdIndexWriteCapacity" } }
        }]
      }
    },
    "ConsolePrivateIntegrationsDynamoDBTable" : {
      "Type" : "AWS::DynamoDB::Table",
      "DependsOn" : "ConsolePrivateInstallsDynamoDBTable" ,
      "Properties" : {
        "TableName" : {"Fn::Join" : ["", [{"Ref": "TablePrefix"}, "-integrations" ]]},
        "AttributeDefinitions" : [
          { "AttributeName" : "id", "AttributeType" : "S" },
          { "AttributeName" : "provider", "AttributeType" : "S" },
          { "AttributeName" : "organization-id", "AttributeType" : "S" }
        ],
        "KeySchema" : [{ "AttributeName" : "id", "KeyType" : "HASH" }],
        "ProvisionedThroughput" : { "ReadCapacityUnits" : { "Ref": "IntegrationsReadCapacity" }, "WriteCapacityUnits" : { "Ref": "IntegrationsWriteCapacity" } },
        "GlobalSecondaryIndexes" : [{
          "IndexName" : "provider-index",
          "Projection": { "ProjectionType": "ALL" },
          "KeySchema" : [{ "AttributeName" : "provider", "KeyType" : "HASH"}],                         
          "ProvisionedThroughput" : { "ReadCapacityUnits" : { "Ref": "IntegrationsProviderIndexReadCapacity" }, "WriteCapacityUnits" : { "Ref": "IntegrationsProviderIndexWriteCapacity" } },
        }, {
        "IndexName" : "organization-id-index",
        "Projection": { "ProjectionType": "ALL" },
        "KeySchema" : [{ "AttributeName" : "organization-id", "KeyType" : "HASH"}],                         
        "ProvisionedThroughput" : { "ReadCapacityUnits" : { "Ref": "IntegrationsOrganizationIdIndexReadCapacity" }, "WriteCapacityUnits" : { "Ref": "IntegrationsOrganizationIdIndexWriteCapacity" } }
        }]
      }
    },
    "ConsolePrivateWebhooksDynamoDBTable" : {
      "Type" : "AWS::DynamoDB::Table",
      "DependsOn" : "ConsolePrivateIntegrationsDynamoDBTable" ,
      "Properties" : {
        "TableName" : {"Fn::Join" : ["", [{"Ref": "TablePrefix"}, "-webhooks" ]]},
        "AttributeDefinitions" : [
          { "AttributeName" : "id", "AttributeType" : "S" },
          { "AttributeName" : "integration-id", "AttributeType" : "S" },
          { "AttributeName" : "remote-id", "AttributeType" : "N" },
          { "AttributeName" : "rack-id", "AttributeType" : "S" },
          { "AttributeName" : "app-id", "AttributeType" : "S" }
        ],
        "KeySchema" : [{ "AttributeName" : "id", "KeyType" : "HASH" }],
        "ProvisionedThroughput" : { "ReadCapacityUnits" : { "Ref": "WebhooksReadCapacity" }, "WriteCapacityUnits" : { "Ref": "WebhooksWriteCapacity" } },
        "GlobalSecondaryIndexes" : [{
          "IndexName" : "integration-id-index",
          "Projection": { "ProjectionType": "ALL" },
          "KeySchema" : [{ "AttributeName" : "integration-id", "KeyType" : "HASH"}],                         
        "ProvisionedThroughput" : { "ReadCapacityUnits" : { "Ref": "WebhooksIntegrationIdIndexReadCapacity" }, "WriteCapacityUnits" : { "Ref": "WebhooksIntegrationIdIndexWriteCapacity" } },
        }, {
        "IndexName" : "remote-id-index",
        "Projection": { "ProjectionType": "ALL" },
        "KeySchema" : [{ "AttributeName" : "remote-id", "KeyType" : "HASH"}],                         
        "ProvisionedThroughput" : { "ReadCapacityUnits" : { "Ref": "WebhooksRemoteIdIndexReadCapacity" }, "WriteCapacityUnits" : { "Ref": "WebhooksRemoteIdIndexWriteCapacity" } },
        }, {
        "IndexName" : "app-id-index",
        "Projection": { "ProjectionType": "ALL" },
        "KeySchema" : [{ "AttributeName" : "app-id", "KeyType" : "HASH"}],                         
        "ProvisionedThroughput" : { "ReadCapacityUnits" : { "Ref": "WebhooksAppIdIndexReadCapacity" }, "WriteCapacityUnits" : { "Ref": "WebhooksAppIdIndexWriteCapacity" } },
        }, {
        "IndexName" : "rack-id-index",
        "Projection": { "ProjectionType": "ALL" },
        "KeySchema" : [{ "AttributeName" : "rack-id", "KeyType" : "HASH"}],                         
        "ProvisionedThroughput" : { "ReadCapacityUnits" : { "Ref": "WebhooksRackIdIndexReadCapacity" }, "WriteCapacityUnits" : { "Ref": "WebhooksRackIdIndexWriteCapacity" } }
        }]
      }
    },
    "ConsolePrivateAuditLogsDynamoDBTable" : {
      "Type" : "AWS::DynamoDB::Table",
      "DependsOn" : "ConsolePrivateIntegrationsDynamoDBTable" ,
      "Properties" : {
        "TableName" : {"Fn::Join" : ["", [{"Ref": "TablePrefix"}, "-audit-logs" ]]},
        "AttributeDefinitions" : [
          { "AttributeName" : "id", "AttributeType" : "S" },
          { "AttributeName" : "rack", "AttributeType" : "S" },
          { "AttributeName" : "timestamp", "AttributeType" : "S" }
        ],
        "KeySchema" : [{ "AttributeName" : "id", "KeyType" : "HASH" }],
        "ProvisionedThroughput" : { "ReadCapacityUnits" : { "Ref": "AuditLogsReadCapacity" }, "WriteCapacityUnits" : { "Ref": "AuditLogsWriteCapacity" } },
        "GlobalSecondaryIndexes" : [{
          "IndexName" : "rack-index",
          "Projection": { "ProjectionType": "ALL" },
          "KeySchema" : [
            { "AttributeName": "rack", "KeyType": "HASH" },
            { "AttributeName": "timestamp", "KeyType": "RANGE" }
          ],
          "ProvisionedThroughput" : { "ReadCapacityUnits" : { "Ref": "AuditLogsRackIndexReadCapacity" }, "WriteCapacityUnits" : { "Ref": "AuditLogsRackIndexWriteCapacity" } }
        }]
      }
    },
    "ConsolePrivateDeployKeysDynamoDBTable" : {
      "Type" : "AWS::DynamoDB::Table",
      "DependsOn" : "ConsolePrivateAuditLogsDynamoDBTable" ,
      "Properties" : {
        "TableName" : {"Fn::Join" : ["", [{"Ref": "TablePrefix"}, "-deploy-keys" ]]},
        "AttributeDefinitions" : [
          { "AttributeName" : "id", "AttributeType" : "S" },
          { "AttributeName" : "key-hash", "AttributeType" : "S" },
          { "AttributeName" : "organization-id", "AttributeType" : "S" },
        ],
        "KeySchema" : [{ "AttributeName" : "id", "KeyType" : "HASH" }],
        "ProvisionedThroughput" : { "ReadCapacityUnits" : { "Ref": "DeployKeysReadCapacity" }, "WriteCapacityUnits" : { "Ref": "DeployKeysWriteCapacity" } },
        "GlobalSecondaryIndexes" : [{
          "IndexName" : "key-hash-index",
          "Projection": { "ProjectionType": "ALL" },
          "KeySchema" : [
            { "AttributeName": "key-hash", "KeyType": "HASH" }
          ],
          "ProvisionedThroughput" : { "ReadCapacityUnits" : { "Ref": "DeployKeysKeyHashIndexReadCapacity"}, "WriteCapacityUnits" : { "Ref": "DeployKeysKeyHashIndexWriteCapacity"} }
        }, {
          "IndexName" : "organization-id-index",
          "Projection": { "ProjectionType": "ALL" },
          "KeySchema" : [
            { "AttributeName": "organization-id", "KeyType": "HASH" }
          ],
          "ProvisionedThroughput" : { "ReadCapacityUnits" : { "Ref": "DeployKeysOrganizationIdIndexReadCapacity"}, "WriteCapacityUnits" : { "Ref": "DeployKeysOrganizationIdIndexWriteCapacity"} }
        }]
      }
    }
  }
}
